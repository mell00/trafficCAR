% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit.R
\name{fit_car}
\alias{fit_car}
\title{Fit Gaussian CAR / ICAR regression via Gibbs sampling}
\usage{
fit_car(
  y,
  A,
  X = NULL,
  type = c("icar", "proper"),
  rho = 0.99,
  tau = 1,
  n_iter = 2000,
  burn_in = floor(n_iter/2),
  thin = 1,
  beta_init = NULL,
  x_init = NULL,
  sigma2_init = NULL,
  b0 = NULL,
  B0 = NULL,
  a0 = 2,
  b0_sigma = 1,
  center_icar = TRUE,
  verbose = FALSE
)
}
\arguments{
\item{y}{Numeric response vector of length n.}

\item{A}{n x n adjacency/weight matrix (base matrix or Matrix sparse type).}

\item{X}{Optional n x p design matrix. If NULL, no regression is fit.}

\item{type}{Either "icar" or "proper".}

\item{rho}{Spatial dependence parameter for proper CAR. Ignored for ICAR.}

\item{tau}{Positive scalar precision multiplier for CAR/ICAR.}

\item{n_iter}{Total MCMC iterations.}

\item{burn_in}{Number of initial iterations to discard.}

\item{thin}{Keep every `thin`-th draw after burn-in.}

\item{beta_init}{Optional initial beta (length p).}

\item{x_init}{Optional initial latent field (length n).}

\item{sigma2_init}{Optional initial sigma^2 (positive).}

\item{b0}{Prior mean for beta (length p). Default 0.}

\item{B0}{Prior covariance for beta (p x p). Default large diagonal.}

\item{a0, b0_sigma}{IG(a0, b0_sigma) prior parameters for sigma^2.}

\item{center_icar}{Whether to enforce sum-to-zero per connected component for ICAR draws.}

\item{verbose}{Whether to print a simple progress message every 10% of iterations.}
}
\value{
An object of class "trafficCAR_fit" with MCMC draws and metadata.
}
\description{
Fits the model
\deqn{y = X \beta + x + \epsilon,\quad \epsilon \sim N(0, \sigma^2 I)}
with CAR/ICAR prior on latent field
\deqn{x \sim N(0, Q^{-1}),\quad Q = \tau (D - \rho A)}
where ICAR corresponds to \eqn{\rho = 1}. Sampling uses the full conditional
\deqn{x \mid \cdot \sim N(Q_*^{-1} b,\; Q_*^{-1}),\quad Q_* = Q + \sigma^{-2} I}
which is SPD even for ICAR once combined with the likelihood.
}
